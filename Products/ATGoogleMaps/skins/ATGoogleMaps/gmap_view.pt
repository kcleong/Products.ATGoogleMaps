<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">
<head>
  <metal:block fill-slot="javascript_head_slot">
    <script type="text/javascript" src=""
	    tal:condition="nothing"
            tal:attributes="src string:$portal_url/atgooglemaps.js">
    </script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <span tal:replace="structure context/gmap"/>
  </metal:block>
</head>

<body>

<metal:main fill-slot="main">
  <tal:main-macro metal:define-macro="main">

    <div tal:replace="structure provider:plone.abovecontenttitle" />

    <h1 class="documentFirstHeading"> 
      <metal:field use-macro="python:context.widget('title', mode='view')">
        Title
      </metal:field>
    </h1>

    <div tal:replace="structure provider:plone.belowcontenttitle" />

    <p class="documentDescription">
      <metal:field use-macro="python:context.widget('description', mode='view')">
        Description
      </metal:field>
    </p>

    <div tal:replace="structure provider:plone.abovecontentbody" />

    <!-- gmarker -->
    <ul tal:define="markers python: context.objectValues(['GMarker'])"
	tal:condition="nothing">
      <tal:gmarker tal:repeat="here markers">
	<li id=""
	    tal:condition="context/point | nothing"
            tal:attributes="id string:marker_link_${context/id}">
          <a href="javascript:void(0)" onclick="this.blur()" tal:content="context/pretty_title_or_id">
            Gmarker title
          </a>
	</li>
        <!-- info window -->
        <div id="" style="display: none;"
             tal:attributes="id string:marker_html_${context/id}">
          <div style="width: 290px;">
	    <div class="documentActions">
	      <a href="" tal:condition="context/url" 
 	         tal:attributes="href context/url" 
 	         i18n:translate="" i18n:domain="plone"> 
 	        Link 
 	      </a> 
 	    </div> 

            <h1 class="documentFirstHeading">
              <a href="" tal:content="context/pretty_title_or_id"
                 tal:attributes="href context/absolute_url">
                Title or id
              </a>
            </h1>

            <img src="" style="float: left; margin: 5px;"
                 tal:condition="context/imageurl"
                 tal:attributes="src context/imageurl" />

	    <div metal:use-macro="context/gmarker_view/macros/gmarker">
	      show related items if they exist
	    </div>
    
            <div style="clear: both;" tal:condition="context/getText"
                 tal:content="structure context/getText">
               Body Text
            </div>

	    <div metal:use-macro="context/document_relateditems/macros/relatedItems">
	      show related items if they exist
	    </div>
          </div>
        </div>
        <div id="" style="display: none;"
             tal:attributes="id string:detail_html_${context/id}"
	     tal:condition="context/detail">
          <div style="width: 290px;">
	    <div class="documentActions">
	      <a href="" tal:condition="context/url" 
 	         tal:attributes="href context/url" 
 	         i18n:translate="" i18n:domain="plone"> 
 	        Link 
 	      </a> 
 	    </div> 

            <h1 class="documentFirstHeading">
              <a href="" tal:content="context/pretty_title_or_id"
                 tal:attributes="href context/absolute_url">
                Title or id
              </a>
            </h1>
            <div tal:content="structure context/getDetail">
               Detail Text
            </div>
	  </div>
	</div>
      </tal:gmarker>
    </ul>
    
    <div id="map_canvas"
         tal:attributes="style string:height: ${context/height}px;;">
    </div>

    <ul class="visualNoMarker">
      <li>
      <a href="gmap.kml">
	<img src="#" tal:attributes="src string:$portal_url/googleearth_icon.gif" />
	<span i18n:domain="googlemaps" i18n:translate="view_google_earth">View in Google Earth</span>
      </a>
      </li>
    </ul>

    <div class="poweredBy">
      Powered by <a href="http://takanory.net/plone/develop/atgooglemaps">ATGoogleMaps</a>
    </div>
    
    <div metal:use-macro="context/document_relateditems/macros/relatedItems">
      show related items if they exist
    </div>
    
    <div tal:replace="structure provider:plone.belowcontentbody" />
  </tal:main-macro>
</metal:main>
    
</body>
</html>
    
